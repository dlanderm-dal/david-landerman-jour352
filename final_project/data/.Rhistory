write.csv(average_spending_per_beneficiary_T, "./fresh_start/facet_T/average_spending_per_beneficiary.csv", row.names = FALSE)
generic_price_deflation<-extended_medicare_full_2012_2023 %>%
select(-matches("^201[2-8]"))
View(generic_price_deflation)
View(generic_price_deflation)
generic_price_deflation<- generic_price_deflation%>%
group_by(generic_name) %>%
summarize(
doses_given_2023=sum(`2023_total_dosage_units`),
number_of_manufacturers_2019 = sum(!is.na(`2019_total_spending`)),
number_of_manufacturers_2020 = sum(!is.na(`2020_total_spending`)),
number_of_manufacturers_2021 = sum(!is.na(`2021_total_spending`)),
number_of_manufacturers_2022 = sum(!is.na(`2022_total_spending`)),
number_of_manufacturers_2023 = sum(!is.na(`2023_total_spending`)),
manufacturer_2019 = first(manufacturer[!is.na(`2019_total_spending`)]),
brand_name_2019 = first(brand_name[!is.na(`2019_total_spending`)]),
max_cost_per_dose_2019 = if_else(number_of_manufacturers_2019 == 0, NA, max(`2019_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
min_cost_per_dose_2019 = if_else(number_of_manufacturers_2019 == 0, NA, min(`2019_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
max_cost_per_dose_2020 = if_else(number_of_manufacturers_2020 == 0, NA, max(`2020_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
min_cost_per_dose_2020 = if_else(number_of_manufacturers_2020 == 0, NA, min(`2020_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
max_cost_per_dose_2021 = if_else(number_of_manufacturers_2021 == 0, NA, max(`2021_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
min_cost_per_dose_2021 = if_else(number_of_manufacturers_2021 == 0, NA, min(`2021_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
max_cost_per_dose_2022 = if_else(number_of_manufacturers_2022 == 0, NA, max(`2022_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
min_cost_per_dose_2022 = if_else(number_of_manufacturers_2022 == 0, NA, min(`2022_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
max_cost_per_dose_2023 = if_else(number_of_manufacturers_2023 == 0, NA, max(`2023_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
min_cost_per_dose_2023 = if_else(number_of_manufacturers_2023 == 0, NA, min(`2023_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
.groups = 'drop'
) %>%
#drugs that were on the market in 2019 (i.e. had same time to deflate as revlimid)
filter(number_of_manufacturers_2019==1) %>%
#drugs that had generics produced by 2023 and had time to deflate)
filter(number_of_manufacturers_2023>1) %>%
#filtering out small run productions
filter(doses_given_2023>1000000) %>%
#create price drop and price drop percentage
mutate(price_drop=min_cost_per_dose_2023-min_cost_per_dose_2019) %>%
mutate(price_drop_percentage=((min_cost_per_dose_2023-min_cost_per_dose_2019)/min_cost_per_dose_2019)) %>%
#filter out extremely low cost drugs with negligible room for cost cutting
filter(min_cost_per_dose_2019>.25) %>%
mutate(change_in_manufacturers=number_of_manufacturers_2023-number_of_manufacturers_2019)
write.csv(generic_price_deflation, "./facet_T/generic_price_deflation.csv", row.names = FALSE)
generic_price_deflation %>%
group_by(manufacturer_2019) %>%
summarize(
manufacturer_frequency=n()
) %>%
arrange(desc(manufacturer_frequency))
View(generic_price_deflation)
generic_price_deflation<- generic_price_deflation%>%
group_by(generic_name) %>%
summarize(
doses_given_2023=sum(`2023_total_dosage_units`),
number_of_manufacturers_2019 = sum(!is.na(`2019_total_spending`)),
number_of_manufacturers_2020 = sum(!is.na(`2020_total_spending`)),
number_of_manufacturers_2021 = sum(!is.na(`2021_total_spending`)),
number_of_manufacturers_2022 = sum(!is.na(`2022_total_spending`)),
number_of_manufacturers_2023 = sum(!is.na(`2023_total_spending`)),
manufacturer_2019 = first(manufacturer[!is.na(`2019_total_spending`)]),
brand_name_2019 = first(brand_name[!is.na(`2019_total_spending`)]),
max_cost_per_dose_2019 = if_else(number_of_manufacturers_2019 == 0, NA, max(`2019_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
min_cost_per_dose_2019 = if_else(number_of_manufacturers_2019 == 0, NA, min(`2019_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
max_cost_per_dose_2020 = if_else(number_of_manufacturers_2020 == 0, NA, max(`2020_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
min_cost_per_dose_2020 = if_else(number_of_manufacturers_2020 == 0, NA, min(`2020_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
max_cost_per_dose_2021 = if_else(number_of_manufacturers_2021 == 0, NA, max(`2021_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
min_cost_per_dose_2021 = if_else(number_of_manufacturers_2021 == 0, NA, min(`2021_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
max_cost_per_dose_2022 = if_else(number_of_manufacturers_2022 == 0, NA, max(`2022_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
min_cost_per_dose_2022 = if_else(number_of_manufacturers_2022 == 0, NA, min(`2022_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
max_cost_per_dose_2023 = if_else(number_of_manufacturers_2023 == 0, NA, max(`2023_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
min_cost_per_dose_2023 = if_else(number_of_manufacturers_2023 == 0, NA, min(`2023_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
.groups = 'drop'
) %>%
#drugs that were on the market in 2019 (i.e. had same time to deflate as revlimid)
filter(number_of_manufacturers_2019==1) %>%
#drugs that had generics produced by 2023 and had time to deflate)
filter(number_of_manufacturers_2023>1) %>%
#filtering out small run productions
filter(doses_given_2023>1000000) %>%
#create price drop and price drop percentage
mutate(price_drop=min_cost_per_dose_2023-min_cost_per_dose_2019) %>%
mutate(price_drop_percentage=((min_cost_per_dose_2023-min_cost_per_dose_2019)/min_cost_per_dose_2019)) %>%
#filter out extremely low cost drugs with negligible room for cost cutting
filter(min_cost_per_dose_2019>.25) %>%
mutate(change_in_manufacturers=number_of_manufacturers_2023-number_of_manufacturers_2019)
generic_price_deflation<- generic_price_deflation%>%
group_by(generic_name) %>%
summarize(
doses_given_2023=sum(`2023_total_dosage_units`),
number_of_manufacturers_2019 = sum(!is.na(`2019_total_spending`)),
number_of_manufacturers_2020 = sum(!is.na(`2020_total_spending`)),
number_of_manufacturers_2021 = sum(!is.na(`2021_total_spending`)),
number_of_manufacturers_2022 = sum(!is.na(`2022_total_spending`)),
number_of_manufacturers_2023 = sum(!is.na(`2023_total_spending`)),
manufacturer_2019 = first(manufacturer[!is.na(`2019_total_spending`)]),
brand_name_2019 = first(brand_name[!is.na(`2019_total_spending`)]),
max_cost_per_dose_2019 = if_else(number_of_manufacturers_2019 == 0, NA, max(`2019_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
min_cost_per_dose_2019 = if_else(number_of_manufacturers_2019 == 0, NA, min(`2019_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
max_cost_per_dose_2020 = if_else(number_of_manufacturers_2020 == 0, NA, max(`2020_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
min_cost_per_dose_2020 = if_else(number_of_manufacturers_2020 == 0, NA, min(`2020_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
max_cost_per_dose_2021 = if_else(number_of_manufacturers_2021 == 0, NA, max(`2021_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
min_cost_per_dose_2021 = if_else(number_of_manufacturers_2021 == 0, NA, min(`2021_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
max_cost_per_dose_2022 = if_else(number_of_manufacturers_2022 == 0, NA, max(`2022_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
min_cost_per_dose_2022 = if_else(number_of_manufacturers_2022 == 0, NA, min(`2022_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
max_cost_per_dose_2023 = if_else(number_of_manufacturers_2023 == 0, NA, max(`2023_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
min_cost_per_dose_2023 = if_else(number_of_manufacturers_2023 == 0, NA, min(`2023_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
.groups = 'drop'
) %>%
#drugs that were on the market in 2019 (i.e. had same time to deflate as revlimid)
filter(number_of_manufacturers_2019==1) %>%
#drugs that had generics produced by 2023 and had time to deflate)
filter(number_of_manufacturers_2023>1) %>%
#filtering out small run productions
filter(doses_given_2023>1000000) %>%
#create price drop and price drop percentage
mutate(price_drop=min_cost_per_dose_2023-min_cost_per_dose_2019) %>%
mutate(price_drop_percentage=((min_cost_per_dose_2023-min_cost_per_dose_2019)/min_cost_per_dose_2019)) %>%
#filter out extremely low cost drugs with negligible room for cost cutting
filter(min_cost_per_dose_2019>.25) %>%
mutate(change_in_manufacturers=number_of_manufacturers_2023-number_of_manufacturers_2019)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(janitor)
library(rio)
library(lubridate)
extended_medicare_2012_2016<-read_csv("./fresh_start/2012-2016_b_wayback.csv") %>%
clean_names()
extended_medicare_2017_2018<-read_csv("./fresh_start/2017-2018_wayback.csv") %>%
clean_names() %>%
filter(manufacturer!="Overall")
extended_medicare_2019_2023<-read_csv("./fresh_start/2019-2023_cms.csv") %>%
clean_names()
extended_medicare_2012_2016 <- extended_medicare_2012_2016 %>%
mutate(manufacturer = if_else(manufacturer == "Celgene", "Celgene/BMS", manufacturer))
extended_medicare_2017_2018 <- extended_medicare_2017_2018 %>%
mutate(manufacturer = if_else(manufacturer == "Celgene", "Celgene/BMS", manufacturer))
extended_medicare_2019_2023 <- extended_medicare_2019_2023 %>%
mutate(manufacturer = if_else(manufacturer == "Celgene", "Celgene/BMS", manufacturer))
extended_medicare_full_2012_2023 <- extended_medicare_2012_2016 %>%
full_join(extended_medicare_2017_2018, by = c("brand_name", "generic_name", "manufacturer")) %>%
full_join(extended_medicare_2019_2023, by = c("brand_name", "generic_name", "manufacturer"))
extended_medicare_full_2012_2023 <- extended_medicare_full_2012_2023 %>%
mutate(across(4:ncol(.), ~ as.numeric(str_remove_all(., "[$,]"))))
names(extended_medicare_full_2012_2023) <- sub("^x", "", names(extended_medicare_full_2012_2023))
#find top 10 2023
top_ten_2023<-extended_medicare_full_2012_2023 %>%
filter('2023_total_dosage_units'>1000000) %>%
arrange(desc('2023_average_spending_per_dosage_unit_weighted')) %>%
slice_head(n=20) %>%
filter(!brand_name %in% c("Humira(Cf) Pen", "Enbrel Sureclick", "Dupixent Pen", "Mounjaro", "Trulicity")) %>%
slice_head(n=10)
top_ten_2023_graphic<-top_ten_2023 %>%
select(brand_name, `2023_total_beneficiaries`,`2023_average_spending_per_dosage_unit_weighted`,`2023_average_spending_per_beneficiary`,`2023_total_spending`,manufacturer,`2023_total_dosage_units`)
#Datawrapper graphic
total_dosage_units <- top_ten_2023 %>%
select(brand_name, contains("total_dosage_units")) %>%
rename_with(~substr(., 1, 4), -brand_name)
write.csv(total_dosage_units, "./fresh_start/facet/total_dosage_units.csv", row.names = FALSE)
total_spending<- top_ten_2023 %>%
select(brand_name, contains("total_spending")) %>%
rename_with(~substr(., 1, 4), -brand_name)
write.csv(total_spending, "./fresh_start/facet/total_spending.csv", row.names = FALSE)
#DATAWRAPPER GRAPH
total_claims <- top_ten_2023 %>%
select(brand_name, contains("total_claims")) %>%
rename_with(~substr(., 1, 4), -brand_name)
write.csv(total_claims, "./fresh_start/facet/total_claims.csv", row.names = FALSE)
total_beneficiaries <- top_ten_2023 %>%
select(brand_name, contains("total_beneficiaries")) %>%
rename_with(~substr(., 1, 4), -brand_name)
write.csv(total_beneficiaries, "./fresh_start/facet/total_beneficiaries.csv", row.names = FALSE)
average_spending_per_dosage_unit_weighted <- top_ten_2023 %>%
select(brand_name, contains("average_spending_per_dosage_unit_weighted")) %>%
rename_with(~substr(., 1, 4), -brand_name)
write.csv(average_spending_per_dosage_unit_weighted, "./fresh_start/facet/average_spending_per_dosage_unit_weighted.csv", row.names = FALSE)
average_spending_per_claim <- top_ten_2023 %>%
select(brand_name, contains("average_spending_per_claim")) %>%
rename_with(~substr(., 1, 4), -brand_name)
write.csv(average_spending_per_claim, "./fresh_start/facet/average_spending_per_claim.csv", row.names = FALSE)
average_spending_per_beneficiary <- top_ten_2023 %>%
select(brand_name, contains("average_spending_per_beneficiary")) %>%
rename_with(~substr(., 1, 4), -brand_name)
write.csv(average_spending_per_beneficiary, "./fresh_start/facet/average_spending_per_beneficiary.csv", row.names = FALSE)
cpi_value<-read_csv("./fresh_start/cpi_value.csv") %>%
clean_names() %>%
filter(year>2011&year<2024)
cpi_value_wide <- cpi_value %>%
select(year, avg) %>%
pivot_wider(names_from = year, values_from = avg) %>%
mutate(brand_name = "CPI")
cpi_context_dosage_cost <- average_spending_per_dosage_unit_weighted %>%
bind_rows(cpi_value_wide)
cpi_percentage<-cpi_context_dosage_cost  %>%
rename(
`2012_value` = `2012`,
`2013_value` = `2013`,
`2014_value` = `2014`,
`2015_value` = `2015`,
`2016_value` = `2016`,
`2017_value` = `2017`,
`2018_value` = `2018`,
`2019_value` = `2019`,
`2020_value` = `2020`,
`2021_value` = `2021`,
`2022_value` = `2022`,
`2023_value` = `2023`
) %>%
rowwise() %>%
mutate(
first_value = coalesce(`2012_value`, `2013_value`, `2014_value`, `2015_value`,
`2016_value`, `2017_value`, `2018_value`, `2019_value`,
`2020_value`, `2021_value`, `2022_value`, `2023_value`),
`2012` = (`2012_value` - first_value) / first_value * 100,
`2013` = (`2013_value` - first_value) / first_value * 100,
`2014` = (`2014_value` - first_value) / first_value * 100,
`2015` = (`2015_value` - first_value) / first_value * 100,
`2016` = (`2016_value` - first_value) / first_value * 100,
`2017` = (`2017_value` - first_value) / first_value * 100,
`2018` = (`2018_value` - first_value) / first_value * 100,
`2019` = (`2019_value` - first_value) / first_value * 100,
`2020` = (`2020_value` - first_value) / first_value * 100,
`2021` = (`2021_value` - first_value) / first_value * 100,
`2022` = (`2022_value` - first_value) / first_value * 100,
`2023` = (`2023_value` - first_value) / first_value * 100
) %>%
ungroup() %>%
select(brand_name, `2012`, `2013`, `2014`, `2015`, `2016`, `2017`, `2018`,
`2019`, `2020`, `2021`, `2022`, `2023`)
write.csv(cpi_percentage, "./fresh_start/facet/cpi_dosage_percent_change.csv", row.names = FALSE)
#DATAWRAPPER GRAPH
total_spending_percent<-total_spending %>%
rename(
`2012_value` = `2012`,
`2013_value` = `2013`,
`2014_value` = `2014`,
`2015_value` = `2015`,
`2016_value` = `2016`,
`2017_value` = `2017`,
`2018_value` = `2018`,
`2019_value` = `2019`,
`2020_value` = `2020`,
`2021_value` = `2021`,
`2022_value` = `2022`,
`2023_value` = `2023`
) %>%
rowwise() %>%
mutate(
first_value = coalesce(`2012_value`, `2013_value`, `2014_value`, `2015_value`,
`2016_value`, `2017_value`, `2018_value`, `2019_value`,
`2020_value`, `2021_value`, `2022_value`, `2023_value`),
`2012` = (`2012_value` - first_value) / first_value * 100,
`2013` = (`2013_value` - first_value) / first_value * 100,
`2014` = (`2014_value` - first_value) / first_value * 100,
`2015` = (`2015_value` - first_value) / first_value * 100,
`2016` = (`2016_value` - first_value) / first_value * 100,
`2017` = (`2017_value` - first_value) / first_value * 100,
`2018` = (`2018_value` - first_value) / first_value * 100,
`2019` = (`2019_value` - first_value) / first_value * 100,
`2020` = (`2020_value` - first_value) / first_value * 100,
`2021` = (`2021_value` - first_value) / first_value * 100,
`2022` = (`2022_value` - first_value) / first_value * 100,
`2023` = (`2023_value` - first_value) / first_value * 100
) %>%
ungroup() %>%
select(brand_name, `2012`, `2013`, `2014`, `2015`, `2016`, `2017`, `2018`,
`2019`, `2020`, `2021`, `2022`, `2023`)
write.csv(total_spending_percent, "./fresh_start/facet/total_spending_percent.csv", row.names = FALSE)
thalidomide<-extended_medicare_full_2012_2023 %>%
filter(brand_name %in% c("Revlimid", "Thalomid", "Pomalidomide", "Pomalyst","Lenalidomide"))
total_dosage_units_T <- thalidomide %>%
select(brand_name, manufacturer, contains("total_dosage_units")) %>%
rename_with(~substr(., 1, 4), !c(brand_name, manufacturer))
write.csv(total_dosage_units_T, "./fresh_start/facet_T/total_dosage_units.csv", row.names = FALSE)
total_spending_T<- thalidomide %>%
select(brand_name, manufacturer, contains("total_spending")) %>%
rename_with(~substr(., 1, 4), !c(brand_name, manufacturer))
write.csv(total_spending_T, "./fresh_start/facet_T/total_spending.csv", row.names = FALSE)
total_claims_T <- thalidomide %>%
select(brand_name, manufacturer, contains("total_claims")) %>%
rename_with(~substr(., 1, 4), !c(brand_name, manufacturer))
write.csv(total_claims_T, "./fresh_start/facet_T/total_claims.csv", row.names = FALSE)
total_beneficiaries_T <- thalidomide %>%
select(brand_name, manufacturer, contains("total_beneficiaries")) %>%
rename_with(~substr(., 1, 4), !c(brand_name, manufacturer))
write.csv(total_beneficiaries_T, "./fresh_start/facet_T/total_beneficiaries.csv", row.names = FALSE)
average_spending_per_dosage_unit_weighted_T <- thalidomide %>%
select(brand_name, manufacturer, contains("average_spending_per_dosage_unit_weighted")) %>%
rename_with(~substr(., 1, 4), !c(brand_name, manufacturer))
write.csv(average_spending_per_dosage_unit_weighted_T, "./fresh_start/facet_T/average_spending_per_dosage_unit_weighted.csv", row.names = FALSE)
average_spending_per_claim_T <- thalidomide %>%
select(brand_name, manufacturer, contains("average_spending_per_claim")) %>%
rename_with(~substr(., 1, 4), !c(brand_name, manufacturer))
write.csv(average_spending_per_claim_T, "./fresh_start/facet_T/average_spending_per_claim.csv", row.names = FALSE)
average_spending_per_beneficiary_T <- thalidomide %>%
select(brand_name, manufacturer, contains("average_spending_per_beneficiary")) %>%
rename_with(~substr(., 1, 4), !c(brand_name, manufacturer))
write.csv(average_spending_per_beneficiary_T, "./fresh_start/facet_T/average_spending_per_beneficiary.csv", row.names = FALSE)
generic_price_deflation<-extended_medicare_full_2012_2023 %>%
select(-matches("^201[2-8]"))
generic_price_deflation1<- generic_price_deflation%>%
group_by(generic_name) %>%
summarize(
doses_given_2023=sum(`2023_total_dosage_units`),
number_of_manufacturers_2019 = sum(!is.na(`2019_total_spending`)),
number_of_manufacturers_2020 = sum(!is.na(`2020_total_spending`)),
number_of_manufacturers_2021 = sum(!is.na(`2021_total_spending`)),
number_of_manufacturers_2022 = sum(!is.na(`2022_total_spending`)),
number_of_manufacturers_2023 = sum(!is.na(`2023_total_spending`)),
manufacturer_2019 = first(manufacturer[!is.na(`2019_total_spending`)]),
brand_name_2019 = first(brand_name[!is.na(`2019_total_spending`)]),
max_cost_per_dose_2019 = if_else(number_of_manufacturers_2019 == 0, NA, max(`2019_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
min_cost_per_dose_2019 = if_else(number_of_manufacturers_2019 == 0, NA, min(`2019_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
max_cost_per_dose_2020 = if_else(number_of_manufacturers_2020 == 0, NA, max(`2020_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
min_cost_per_dose_2020 = if_else(number_of_manufacturers_2020 == 0, NA, min(`2020_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
max_cost_per_dose_2021 = if_else(number_of_manufacturers_2021 == 0, NA, max(`2021_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
min_cost_per_dose_2021 = if_else(number_of_manufacturers_2021 == 0, NA, min(`2021_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
max_cost_per_dose_2022 = if_else(number_of_manufacturers_2022 == 0, NA, max(`2022_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
min_cost_per_dose_2022 = if_else(number_of_manufacturers_2022 == 0, NA, min(`2022_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
max_cost_per_dose_2023 = if_else(number_of_manufacturers_2023 == 0, NA, max(`2023_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
min_cost_per_dose_2023 = if_else(number_of_manufacturers_2023 == 0, NA, min(`2023_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
.groups = 'drop'
) %>%
#drugs that were on the market in 2019 (i.e. had same time to deflate as revlimid)
filter(number_of_manufacturers_2019==1) %>%
#drugs that had generics produced by 2023 and had time to deflate)
filter(number_of_manufacturers_2023>1) %>%
#filtering out small run productions
filter(doses_given_2023>1000000) %>%
#create price drop and price drop percentage
mutate(price_drop=min_cost_per_dose_2023-min_cost_per_dose_2019) %>%
mutate(price_drop_percentage=((min_cost_per_dose_2023-min_cost_per_dose_2019)/min_cost_per_dose_2019)) %>%
#filter out extremely low cost drugs with negligible room for cost cutting
filter(min_cost_per_dose_2019>.25) %>%
mutate(change_in_manufacturers=number_of_manufacturers_2023-number_of_manufacturers_2019)
write.csv(generic_price_deflation1, "./facet_T/generic_price_deflation.csv", row.names = FALSE)
generic_price_deflation %>%
group_by(manufacturer_2019) %>%
summarize(
manufacturer_frequency=n()
) %>%
arrange(desc(manufacturer_frequency))
generic_price_deflation1<- generic_price_deflation%>%
group_by(generic_name) %>%
summarize(
doses_given_2023=sum(`2023_total_dosage_units`),
number_of_manufacturers_2019 = sum(!is.na(`2019_total_spending`)),
number_of_manufacturers_2020 = sum(!is.na(`2020_total_spending`)),
number_of_manufacturers_2021 = sum(!is.na(`2021_total_spending`)),
number_of_manufacturers_2022 = sum(!is.na(`2022_total_spending`)),
number_of_manufacturers_2023 = sum(!is.na(`2023_total_spending`)),
manufacturer_2019 = first(manufacturer[!is.na(`2019_total_spending`)]),
brand_name_2019 = first(brand_name[!is.na(`2019_total_spending`)]),
max_cost_per_dose_2019 = if_else(number_of_manufacturers_2019 == 0, NA, max(`2019_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
min_cost_per_dose_2019 = if_else(number_of_manufacturers_2019 == 0, NA, min(`2019_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
max_cost_per_dose_2020 = if_else(number_of_manufacturers_2020 == 0, NA, max(`2020_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
min_cost_per_dose_2020 = if_else(number_of_manufacturers_2020 == 0, NA, min(`2020_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
max_cost_per_dose_2021 = if_else(number_of_manufacturers_2021 == 0, NA, max(`2021_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
min_cost_per_dose_2021 = if_else(number_of_manufacturers_2021 == 0, NA, min(`2021_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
max_cost_per_dose_2022 = if_else(number_of_manufacturers_2022 == 0, NA, max(`2022_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
min_cost_per_dose_2022 = if_else(number_of_manufacturers_2022 == 0, NA, min(`2022_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
max_cost_per_dose_2023 = if_else(number_of_manufacturers_2023 == 0, NA, max(`2023_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
min_cost_per_dose_2023 = if_else(number_of_manufacturers_2023 == 0, NA, min(`2023_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
.groups = 'drop'
) %>%
#drugs that were on the market in 2019 (i.e. had same time to deflate as revlimid)
filter(number_of_manufacturers_2019==1) %>%
#drugs that had generics produced by 2023 and had time to deflate)
filter(number_of_manufacturers_2023>1) %>%
#filtering out small run productions
filter(doses_given_2023>1000000) %>%
#create price drop and price drop percentage
mutate(price_drop=min_cost_per_dose_2023-min_cost_per_dose_2019) %>%
mutate(price_drop_percentage=((min_cost_per_dose_2023-min_cost_per_dose_2019)/min_cost_per_dose_2019)) %>%
#filter out extremely low cost drugs with negligible room for cost cutting
filter(min_cost_per_dose_2019>.25) %>%
mutate(change_in_manufacturers=number_of_manufacturers_2023-number_of_manufacturers_2019)
write.csv(generic_price_deflation1, "./facet_T/generic_price_deflation.csv", row.names = FALSE)
generic_price_deflation1 %>%
group_by(manufacturer_2019) %>%
summarize(
manufacturer_frequency=n()
) %>%
arrange(desc(manufacturer_frequency))
generic_price_deflation1<- generic_price_deflation%>%
group_by(generic_name) %>%
summarize(
doses_given_2023=sum(`2023_total_dosage_units`),
number_of_manufacturers_2019 = sum(!is.na(`2019_total_spending`)),
number_of_manufacturers_2020 = sum(!is.na(`2020_total_spending`)),
number_of_manufacturers_2021 = sum(!is.na(`2021_total_spending`)),
number_of_manufacturers_2022 = sum(!is.na(`2022_total_spending`)),
number_of_manufacturers_2023 = sum(!is.na(`2023_total_spending`)),
manufacturer_2019 = first(manufacturer[!is.na(`2019_total_spending`)]),
brand_name_2019 = first(brand_name[!is.na(`2019_total_spending`)]),
max_cost_per_dose_2019 = if_else(number_of_manufacturers_2019 == 0, NA, max(`2019_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
min_cost_per_dose_2019 = if_else(number_of_manufacturers_2019 == 0, NA, min(`2019_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
max_cost_per_dose_2020 = if_else(number_of_manufacturers_2020 == 0, NA, max(`2020_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
min_cost_per_dose_2020 = if_else(number_of_manufacturers_2020 == 0, NA, min(`2020_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
max_cost_per_dose_2021 = if_else(number_of_manufacturers_2021 == 0, NA, max(`2021_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
min_cost_per_dose_2021 = if_else(number_of_manufacturers_2021 == 0, NA, min(`2021_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
max_cost_per_dose_2022 = if_else(number_of_manufacturers_2022 == 0, NA, max(`2022_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
min_cost_per_dose_2022 = if_else(number_of_manufacturers_2022 == 0, NA, min(`2022_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
max_cost_per_dose_2023 = if_else(number_of_manufacturers_2023 == 0, NA, max(`2023_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
min_cost_per_dose_2023 = if_else(number_of_manufacturers_2023 == 0, NA, min(`2023_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
.groups = 'drop'
) %>%
#drugs that were on the market in 2019 (i.e. had same time to deflate as revlimid)
filter(number_of_manufacturers_2019==1) %>%
#drugs that had generics produced by 2023 and had time to deflate)
filter(number_of_manufacturers_2023>1) %>%
#filtering out small run productions
filter(doses_given_2023>1000000) %>%
#create price drop and price drop percentage
mutate(price_drop=min_cost_per_dose_2023-min_cost_per_dose_2019) %>%
mutate(price_drop_percentage=((min_cost_per_dose_2023-min_cost_per_dose_2019)/min_cost_per_dose_2019)) %>%
#filter out extremely low cost drugs with negligible room for cost cutting
filter(min_cost_per_dose_2019>.25) %>%
mutate(change_in_manufacturers=number_of_manufacturers_2023-number_of_manufacturers_2019)
write.csv(generic_price_deflation1, "./fresh_start/facet_T/generic_price_deflation.csv", row.names = FALSE)
generic_price_deflation1 %>%
group_by(manufacturer_2019) %>%
summarize(
manufacturer_frequency=n()
) %>%
arrange(desc(manufacturer_frequency))
View(extended_medicare_full_2012_2023)
full_medicare_d_unfiltered<-read_csv("full_medicare_d_unfiltered.csv")
full_medicare_d_unfiltered<-read_csv(".fresh_start/full_medicare_d_unfiltered.csv")
full_medicare_d_unfiltered<-read_csv("./fresh_start/full_medicare_d_unfiltered.csv")
View(full_medicare_d_unfiltered)
full_medicare_d_unfiltered<-read_csv("./fresh_start/full_medicare_d_unfiltered.csv") %>%
clean_names()
View(full_medicare_d_unfiltered)
generic_price_deflation1<- full_medicare_d_unfiltered%>%
group_by(generic_name) %>%
summarize(
doses_given_2023=sum(`2023_total_dosage_units`),
number_of_manufacturers_2019 = sum(!is.na(`2019_total_spending`)),
number_of_manufacturers_2020 = sum(!is.na(`2020_total_spending`)),
number_of_manufacturers_2021 = sum(!is.na(`2021_total_spending`)),
number_of_manufacturers_2022 = sum(!is.na(`2022_total_spending`)),
number_of_manufacturers_2023 = sum(!is.na(`2023_total_spending`)),
manufacturer_2019 = first(manufacturer[!is.na(`2019_total_spending`)]),
brand_name_2019 = first(brand_name[!is.na(`2019_total_spending`)]),
max_cost_per_dose_2019 = if_else(number_of_manufacturers_2019 == 0, NA, max(`2019_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
min_cost_per_dose_2019 = if_else(number_of_manufacturers_2019 == 0, NA, min(`2019_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
max_cost_per_dose_2020 = if_else(number_of_manufacturers_2020 == 0, NA, max(`2020_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
min_cost_per_dose_2020 = if_else(number_of_manufacturers_2020 == 0, NA, min(`2020_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
max_cost_per_dose_2021 = if_else(number_of_manufacturers_2021 == 0, NA, max(`2021_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
min_cost_per_dose_2021 = if_else(number_of_manufacturers_2021 == 0, NA, min(`2021_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
max_cost_per_dose_2022 = if_else(number_of_manufacturers_2022 == 0, NA, max(`2022_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
min_cost_per_dose_2022 = if_else(number_of_manufacturers_2022 == 0, NA, min(`2022_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
max_cost_per_dose_2023 = if_else(number_of_manufacturers_2023 == 0, NA, max(`2023_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
min_cost_per_dose_2023 = if_else(number_of_manufacturers_2023 == 0, NA, min(`2023_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
.groups = 'drop'
) %>%
#drugs that were on the market in 2019 (i.e. had same time to deflate as revlimid)
filter(number_of_manufacturers_2019==1) %>%
#drugs that had generics produced by 2023 and had time to deflate)
filter(number_of_manufacturers_2023>1) %>%
#filtering out small run productions
filter(doses_given_2023>1000000) %>%
#create price drop and price drop percentage
mutate(price_drop=min_cost_per_dose_2023-min_cost_per_dose_2019) %>%
mutate(price_drop_percentage=((min_cost_per_dose_2023-min_cost_per_dose_2019)/min_cost_per_dose_2019)) %>%
#filter out extremely low cost drugs with negligible room for cost cutting
filter(min_cost_per_dose_2019>.25) %>%
mutate(change_in_manufacturers=number_of_manufacturers_2023-number_of_manufacturers_2019)
full_medicare_d_unfiltered<-read_csv("./fresh_start/full_medicare_d_unfiltered.csv") %>%
clean_names()
names(full_medicare_d_unfiltered) <- sub("^x", "", names(full_medicare_d_unfiltered))
generic_price_deflation1<- full_medicare_d_unfiltered%>%
group_by(generic_name) %>%
summarize(
doses_given_2023=sum(`2023_total_dosage_units`),
number_of_manufacturers_2019 = sum(!is.na(`2019_total_spending`)),
number_of_manufacturers_2020 = sum(!is.na(`2020_total_spending`)),
number_of_manufacturers_2021 = sum(!is.na(`2021_total_spending`)),
number_of_manufacturers_2022 = sum(!is.na(`2022_total_spending`)),
number_of_manufacturers_2023 = sum(!is.na(`2023_total_spending`)),
manufacturer_2019 = first(manufacturer[!is.na(`2019_total_spending`)]),
brand_name_2019 = first(brand_name[!is.na(`2019_total_spending`)]),
max_cost_per_dose_2019 = if_else(number_of_manufacturers_2019 == 0, NA, max(`2019_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
min_cost_per_dose_2019 = if_else(number_of_manufacturers_2019 == 0, NA, min(`2019_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
max_cost_per_dose_2020 = if_else(number_of_manufacturers_2020 == 0, NA, max(`2020_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
min_cost_per_dose_2020 = if_else(number_of_manufacturers_2020 == 0, NA, min(`2020_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
max_cost_per_dose_2021 = if_else(number_of_manufacturers_2021 == 0, NA, max(`2021_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
min_cost_per_dose_2021 = if_else(number_of_manufacturers_2021 == 0, NA, min(`2021_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
max_cost_per_dose_2022 = if_else(number_of_manufacturers_2022 == 0, NA, max(`2022_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
min_cost_per_dose_2022 = if_else(number_of_manufacturers_2022 == 0, NA, min(`2022_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
max_cost_per_dose_2023 = if_else(number_of_manufacturers_2023 == 0, NA, max(`2023_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
min_cost_per_dose_2023 = if_else(number_of_manufacturers_2023 == 0, NA, min(`2023_average_spending_per_dosage_unit_weighted`, na.rm = TRUE)),
.groups = 'drop'
) %>%
#drugs that were on the market in 2019 (i.e. had same time to deflate as revlimid)
filter(number_of_manufacturers_2019==1) %>%
#drugs that had generics produced by 2023 and had time to deflate)
filter(number_of_manufacturers_2023>1) %>%
#filtering out small run productions
filter(doses_given_2023>1000000) %>%
#create price drop and price drop percentage
mutate(price_drop=min_cost_per_dose_2023-min_cost_per_dose_2019) %>%
mutate(price_drop_percentage=((min_cost_per_dose_2023-min_cost_per_dose_2019)/min_cost_per_dose_2019)) %>%
#filter out extremely low cost drugs with negligible room for cost cutting
filter(min_cost_per_dose_2019>.25) %>%
mutate(change_in_manufacturers=number_of_manufacturers_2023-number_of_manufacturers_2019)
write.csv(generic_price_deflation1, "./fresh_start/facet_T/generic_price_deflation.csv", row.names = FALSE)
generic_price_deflation1 %>%
group_by(manufacturer_2019) %>%
summarize(
manufacturer_frequency=n()
) %>%
arrange(desc(manufacturer_frequency))
View(generic_price_deflation1)
